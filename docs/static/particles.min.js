(function(){window.mapleParticles=function(b,s){var f={num:200,size:{minSize:1,maxSize:50},zone:{x:[0.01,0.99],y:[0.01,0.99]},speed:{x:[-1,1],y:[-1,1],ax:[-0.01,0.01],ay:[-0.01,0.01]},time:{fadeIn:500,fadeOut:4000},atmosphere:[{start:{r:0,g:160,b:191,a:0.3},end:{r:64,g:224,b:255,a:0.7,}},{start:{r:64,g:191,b:0,a:0.3},end:{r:128,g:255,b:64,a:0.7}}],background:"rgba(0,0,0,0.9)",atmosphereBG:true,mode:"lighter",follow:false,active:50,perspective:0.2,sizeToZLevel:true,blur:true};if(!s){s={}}for(key in f){if(f.hasOwnProperty(key)&&!s.hasOwnProperty(key)){s[key]=f[key]}}if(b&&b.getContext){if(!window.requestAnimationFrame){window.requestAnimationFrame=function(u){setTimeout(u,16)}}var p;var g=true;var l=[];var r=0,q=0,k=0,j=0,e=0.5,c=0.5;var m=b.getContext("2d");m.globalCompositeOperation="lighter";var i=function(){b.width=b.clientWidth;b.height=b.clientHeight};var a=function(){var x=Math.random()*(s.time.fadeIn+s.time.fadeOut)*2|0;var y=Math.pow(Math.random(),4);var w=1-(1-(s.sizeToZLevel?y:Math.random()))*(1-s.perspective);var v=s.size.minSize+y*(s.size.maxSize-s.size.minSize)|0;var u=s.atmosphere[Math.random()*s.atmosphere.length|0];return{x:(s.follow?e:(s.zone.x[0]+Math.random()*(s.zone.x[1]-s.zone.x[0])))*b.width,y:(s.follow?c:(s.zone.y[0]+Math.random()*(s.zone.y[1]-s.zone.y[0])))*b.height,z:0,zLevel:w,sr:v,er:v*1.5,speedX:(s.speed.x[0]+Math.random()*(s.speed.x[1]-s.speed.x[0]))*w,speedY:(s.speed.y[0]+Math.random()*(s.speed.y[1]-s.speed.y[0]))*w,ax:(s.speed.ax[0]+Math.random()*(s.speed.ax[1]-s.speed.ax[0]))*w,ay:(s.speed.ay[0]+Math.random()*(s.speed.ay[1]-s.speed.ay[0]))*w,pro:0,offsetTime:x,timeOut:x,color:[u.start.r+(Math.random()*(u.end.r-u.start.r))|0,u.start.g+(Math.random()*(u.end.g-u.start.g))|0,u.start.b+(Math.random()*(u.end.b-u.start.b))|0,u.start.a+(Math.random()*(u.end.a-u.start.a))],glow:true}};var t=function(){if(l.length!==s.num){if(l.length<s.num){for(var v=l.length;v<s.num;v++){l.push(a())}}else{l.length=s.num}}l.sort(function A(C,B){return C.zLevel-B.zLevel});k=r-(r-k)*0.95;j=q-(q-j)*0.95;m.globalCompositeOperation="source-over";if(s.atmosphereBG){if(s.atmosphere.length>1){var u=m.createLinearGradient(0,0,b.width,b.height);u.addColorStop(0,"rgba("+((s.atmosphere[0].start.r+s.atmosphere[0].end.r)/2|0)+","+((s.atmosphere[0].start.g+s.atmosphere[0].end.g)/2|0)+","+((s.atmosphere[0].start.b+s.atmosphere[0].end.b)/2|0)+","+"1)");u.addColorStop(1,"rgba("+((s.atmosphere[1].start.r+s.atmosphere[1].end.r)/2|0)+","+((s.atmosphere[1].start.g+s.atmosphere[1].end.g)/2|0)+","+((s.atmosphere[1].start.b+s.atmosphere[1].end.b)/2|0)+","+"1)");m.fillStyle=u}else{m.fillStyle="rgba("+((s.atmosphere[0].start.r+s.atmosphere[0].end.r)/2|0)+","+((s.atmosphere[0].start.g+s.atmosphere[0].end.g)/2|0)+","+((s.atmosphere[0].start.b+s.atmosphere[0].end.b)/2|0)+","+"1)"}m.fillRect(0,0,b.width,b.height)}m.clearRect(0,0,b.width,b.height);m.fillStyle=s.background?s.background:"rgba(0,0,0,0.9)";m.fillRect(0,0,b.width,b.height);m.globalCompositeOperation=s.mode?s.mode:"lighter";var y,x,w;for(var v=0;v<l.length;v++){if(l[v].timeOut>0&&(l[v].timeOut-=16)<=0){if(s.follow){l[v].x=e*b.width;l[v].y=c*b.height}else{l[v].x=(s.follow?e:(s.zone.x[0]+Math.random()*(s.zone.x[1]-s.zone.x[0])))*b.width;l[v].y=(s.follow?c:(s.zone.y[0]+Math.random()*(s.zone.y[1]-s.zone.y[0])))*b.height}}if(l[v].timeOut<=0){if(l[v].pro>0){l[v].x+=l[v].speedX;l[v].y+=l[v].speedY;l[v].rx=l[v].x+k*l[v].zLevel/s.size.minSize*s.active;l[v].ry=l[v].y+j*l[v].zLevel/s.size.minSize*s.active;l[v].speedX+=l[v].ax;l[v].speedY+=l[v].ay;y="rgba("+l[v].color[0]+","+l[v].color[1]+","+l[v].color[2]+",";x=l[v].color[3]*l[v].pro;var z=(0.9+l[v].pro*0.1);if(s.blur){w=m.createRadialGradient(l[v].rx,l[v].ry,l[v].sr*z,l[v].rx,l[v].ry,l[v].er*z);w.addColorStop(0,y+x+")");w.addColorStop(0.5,y+x*0.25+")");w.addColorStop(1,y+"0)");m.fillStyle=w;m.fillRect(l[v].rx-l[v].er,l[v].ry-l[v].er,l[v].er*2,l[v].er*2)}else{m.beginPath();m.arc(l[v].rx,l[v].ry,l[v].sr*z,0,2*Math.PI);m.fillStyle=y+x+")";m.fill()}if(l[v].glow){l[v].pro+=(16/s.time.fadeIn);if(l[v].pro>=1){l[v].glow=false}}else{l[v].pro-=(16/s.time.fadeOut)}}else{if(l[v].glow){l[v].pro+=(16/s.time.fadeIn)}else{l[v]=a(l[v].offsetTime)}}}}p=window.requestAnimationFrame(t)};var h=function(){if(g){p=window.requestAnimationFrame(t);g=false}};var d=function(){window.cancelAnimationFrame(p);g=true};var o=function(){l=[]};var n=function(){i();window.addEventListener("resize",i);b.addEventListener("mousemove",function(v){e=v.offsetX/b.width;c=v.offsetY/b.height;r=(e-0.5)*2;q=(c-0.5)*2});b.addEventListener("touchmove",function(v){e=v.touches[0].clientX/b.width;c=v.touches[0].clientY/b.height;r=(e-0.5)*2;q=(c-0.5)*2});for(var u=0;u<s.num;u++){l.push(a())}p=window.requestAnimationFrame(t);g=false};n();return{config:s,start:h,pause:d,reset:o,canvas:b}}}})();